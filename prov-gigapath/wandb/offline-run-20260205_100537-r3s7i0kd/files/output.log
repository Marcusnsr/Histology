wandb: Detected [huggingface_hub.inference] in use.
wandb: Use W&B Weave for improved LLM call tracing. Install Weave with `pip install weave` then add `import weave` to the top of your script.
wandb: For more information, check out the docs at: https://weave-docs.wandb.ai/
/home/dlf903/miniconda3/envs/gigapath/lib/python3.9/site-packages/sklearn/model_selection/_split.py:776: UserWarning: The least populated class in y has only 2 members, which is less than n_splits=5.
  warnings.warn(
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
  | Name     | Type       | Params | Mode
------------------------------------------------
0 | backbone | Sequential | 7.0 M  | train
1 | head     | Linear     | 1.5 K  | train
2 | loss_fn  | FocalLoss  | 0      | train
------------------------------------------------
7.0 M     Trainable params
0         Non-trainable params
7.0 M     Total params
27.815    Total estimated model params size (MB)
15        Modules in train mode
0         Modules in eval mode
Epoch 24: 100%|██████████| 23/23 [00:33<00:00,  0.69it/s, v_num=i0kd, train_loss=0.061, val_loss=0.0459, val_accuracy=0.156]

Epoch 99: 100%|██████████| 23/23 [00:58<00:00,  0.39it/s, v_num=i0kd, train_loss=0.0375, val_loss=0.0434, val_accuracy=0.200]
Fold 0 complete. Best model: /home/dlf903/Histology_v2/Decoder/models/Approx_Nancy_Score_fold0/best-checkpoint.ckpt
=== Starting Fold 2/5 ===
Task: Multiclass (6). Weights: tensor([0.0385, 0.0478, 0.0239, 0.0255, 0.0752, 0.7892])
Epoch 18:  70%|██████▉   | 16/23 [00:38<00:16,  0.42it/s, v_num=i0kd, train_loss=0.0494, val_loss=0.0437, val_accuracy=0.111]
`Trainer.fit` stopped: `max_epochs=100` reached.
/home/dlf903/miniconda3/envs/gigapath/lib/python3.9/site-packages/sklearn/model_selection/_split.py:776: UserWarning: The least populated class in y has only 2 members, which is less than n_splits=5.
  warnings.warn(
/home/dlf903/miniconda3/envs/gigapath/lib/python3.9/site-packages/lightning/fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python /home/dlf903/Histology_v2/Decoder/gigapath_decoder.p ...
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/dlf903/miniconda3/envs/gigapath/lib/python3.9/site-packages/lightning/pytorch/loggers/wandb.py:397: There is a wandb run already in progress and newly created instances of `WandbLogger` will reuse this run. If this is not desired, call `wandb.finish()` before instantiating `WandbLogger`.
/home/dlf903/miniconda3/envs/gigapath/lib/python3.9/site-packages/sklearn/model_selection/_split.py:776: UserWarning: The least populated class in y has only 2 members, which is less than n_splits=5.
  warnings.warn(
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
  | Name     | Type       | Params | Mode
------------------------------------------------
0 | backbone | Sequential | 7.0 M  | train
1 | head     | Linear     | 1.5 K  | train
2 | loss_fn  | FocalLoss  | 0      | train
------------------------------------------------
7.0 M     Trainable params
0         Non-trainable params
7.0 M     Total params
27.815    Total estimated model params size (MB)
15        Modules in train mode

Epoch 99: 100%|██████████| 23/23 [00:43<00:00,  0.53it/s, v_num=i0kd, train_loss=0.0336, val_loss=0.0417, val_accuracy=0.0889]
Fold 1 complete. Best model: /home/dlf903/Histology_v2/Decoder/models/Approx_Nancy_Score_fold1/best-checkpoint.ckpt
=== Starting Fold 3/5 ===
Task: Multiclass (6). Weights: tensor([0.0385, 0.0478, 0.0239, 0.0255, 0.0752, 0.7892])
Epoch 6: 100%|██████████| 23/23 [00:33<00:00,  0.68it/s, v_num=i0kd, train_loss=0.0373, val_loss=0.0426, val_accuracy=0.156]
Validation DataLoader 0: 100%|██████████| 6/6 [00:02<00:00,  2.44it/s]
`Trainer.fit` stopped: `max_epochs=100` reached.
/home/dlf903/miniconda3/envs/gigapath/lib/python3.9/site-packages/sklearn/model_selection/_split.py:776: UserWarning: The least populated class in y has only 2 members, which is less than n_splits=5.
  warnings.warn(
/home/dlf903/miniconda3/envs/gigapath/lib/python3.9/site-packages/lightning/fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python /home/dlf903/Histology_v2/Decoder/gigapath_decoder.p ...
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/dlf903/miniconda3/envs/gigapath/lib/python3.9/site-packages/lightning/pytorch/loggers/wandb.py:397: There is a wandb run already in progress and newly created instances of `WandbLogger` will reuse this run. If this is not desired, call `wandb.finish()` before instantiating `WandbLogger`.
/home/dlf903/miniconda3/envs/gigapath/lib/python3.9/site-packages/sklearn/model_selection/_split.py:776: UserWarning: The least populated class in y has only 2 members, which is less than n_splits=5.
  warnings.warn(
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
  | Name     | Type       | Params | Mode
------------------------------------------------
0 | backbone | Sequential | 7.0 M  | train
1 | head     | Linear     | 1.5 K  | train
2 | loss_fn  | FocalLoss  | 0      | train
------------------------------------------------
7.0 M     Trainable params
0         Non-trainable params
7.0 M     Total params
27.815    Total estimated model params size (MB)
15        Modules in train mode


Validation DataLoader 0: 100%|██████████| 6/6 [00:02<00:00,  2.56it/s]
`Trainer.fit` stopped: `max_epochs=100` reached.
/home/dlf903/miniconda3/envs/gigapath/lib/python3.9/site-packages/sklearn/model_selection/_split.py:776: UserWarning: The least populated class in y has only 2 members, which is less than n_splits=5.
  warnings.warn(
/home/dlf903/miniconda3/envs/gigapath/lib/python3.9/site-packages/lightning/fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python /home/dlf903/Histology_v2/Decoder/gigapath_decoder.p ...
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/dlf903/miniconda3/envs/gigapath/lib/python3.9/site-packages/lightning/pytorch/loggers/wandb.py:397: There is a wandb run already in progress and newly created instances of `WandbLogger` will reuse this run. If this is not desired, call `wandb.finish()` before instantiating `WandbLogger`.
/home/dlf903/miniconda3/envs/gigapath/lib/python3.9/site-packages/sklearn/model_selection/_split.py:776: UserWarning: The least populated class in y has only 2 members, which is less than n_splits=5.
  warnings.warn(
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
  | Name     | Type       | Params | Mode
------------------------------------------------
0 | backbone | Sequential | 7.0 M  | train
1 | head     | Linear     | 1.5 K  | train
2 | loss_fn  | FocalLoss  | 0      | train
------------------------------------------------
7.0 M     Trainable params
0         Non-trainable params
7.0 M     Total params
27.815    Total estimated model params size (MB)
15        Modules in train mode
Epoch 99: 100%|██████████| 23/23 [00:44<00:00,  0.51it/s, v_num=i0kd, train_loss=0.0438, val_loss=0.0431, val_accuracy=0.111]
Fold 2 complete. Best model: /home/dlf903/Histology_v2/Decoder/models/Approx_Nancy_Score_fold2/best-checkpoint.ckpt
=== Starting Fold 4/5 ===
Task: Multiclass (6). Weights: tensor([0.0385, 0.0478, 0.0239, 0.0255, 0.0752, 0.7892])
Epoch 41: 100%|██████████| 23/23 [00:38<00:00,  0.59it/s, v_num=i0kd, train_loss=0.0156, val_loss=0.0727, val_accuracy=0.133]

Validation: |          | 0/? [00:00<?, ?it/s]
`Trainer.fit` stopped: `max_epochs=100` reached.
/home/dlf903/miniconda3/envs/gigapath/lib/python3.9/site-packages/sklearn/model_selection/_split.py:776: UserWarning: The least populated class in y has only 2 members, which is less than n_splits=5.
  warnings.warn(
/home/dlf903/miniconda3/envs/gigapath/lib/python3.9/site-packages/lightning/fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python /home/dlf903/Histology_v2/Decoder/gigapath_decoder.p ...
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/dlf903/miniconda3/envs/gigapath/lib/python3.9/site-packages/lightning/pytorch/loggers/wandb.py:397: There is a wandb run already in progress and newly created instances of `WandbLogger` will reuse this run. If this is not desired, call `wandb.finish()` before instantiating `WandbLogger`.
/home/dlf903/miniconda3/envs/gigapath/lib/python3.9/site-packages/sklearn/model_selection/_split.py:776: UserWarning: The least populated class in y has only 2 members, which is less than n_splits=5.
  warnings.warn(
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
  | Name     | Type       | Params | Mode
------------------------------------------------
0 | backbone | Sequential | 7.0 M  | train
1 | head     | Linear     | 1.5 K  | train
2 | loss_fn  | FocalLoss  | 0      | train
------------------------------------------------
7.0 M     Trainable params
0         Non-trainable params
7.0 M     Total params
27.815    Total estimated model params size (MB)
15        Modules in train mode
Fold 3 complete. Best model: /home/dlf903/Histology_v2/Decoder/models/Approx_Nancy_Score_fold3/best-checkpoint.ckpt
=== Starting Fold 5/5 ===
Task: Multiclass (6). Weights: tensor([0.0385, 0.0478, 0.0239, 0.0255, 0.0752, 0.7892])
Epoch 34: 100%|██████████| 23/23 [00:37<00:00,  0.62it/s, v_num=i0kd, train_loss=0.0765, val_loss=0.0894, val_accuracy=0.156]

Validation DataLoader 0:  83%|████████▎ | 5/6 [00:03<00:00,  1.56it/s]
Epoch 99: 100%|██████████| 23/23 [00:32<00:00,  0.70it/s, v_num=i0kd, train_loss=0.0604, val_loss=0.103, val_accuracy=0.133]
Fold 4 complete. Best model: /home/dlf903/Histology_v2/Decoder/models/Approx_Nancy_Score_fold4/best-checkpoint.ckpt